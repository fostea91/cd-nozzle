function [M, z, r] = trans_nozzle(nu, xi, gm, rcsub)

r = ((1+2*rcsub)^0.5)*sinh(nu)/(cosh(nu)+cos(xi));
z = ((1+2*rcsub)^0.5)*sin(xi)/(cosh(nu)+cos(xi));

u1 = 0.5*r^2 - 0.25 + z;
v1 = 0.25*r^3 - 0.25*r + r*z;
    
u2 = ((2*gm+9)/24)*r^4 - ((4*gm+15)/24)*r^2 + ...
     ((10*gm+57)/288) + z*(r^2 - 5/8) - ((2*gm-3)/6)*z^2;
    
v2 = ((gm+3)/9)*r^5 - ((20*gm+63)/96)*r^3 + ...
     ((28*gm+93)/288)*r + z*(((2*gm+9)/6)*r^3 - ...
     ((4*gm+15)/12)*r) + r*z^2;
    
u3 = ((556*gm^2+1737*gm+3069)/10368)*r^6 - ...
     ((388*gm^2+1161*gm+1881)/2304)*r^4 + ...
     ((304*gm^2+831*gm+1242)/1728)*r^2 - ...
     ((2708*gm^2+7839*gm+14211)/82944) + ...
     (((52*gm^2+51*gm+327)/384)*r^4 - ...
     ((52*gm^2+75*gm+279)/192)*r^2 + ...
     ((92*gm^2+180*gm+639)/1152))*z + ...
     (((-7*gm-3)/8)*r^2 + ((13*gm-27)/48))*z^2 + ...
     ((4*gm^2-57*gm+27)/144)*z^3;
    
v3 = ((6836*gm^2+23031*gm+30627)/82944)*r^7 - ...
     ((3380*gm^2+11391*gm+15291)/13824)*r^5 + ...
     ((3424*gm^2+11271*gm+15228)/13824)*r^3 - ...
     ((7100*gm^2+22311*gm+30249)/82944)*r + ...
     (((556*gm^2+1737*gm+3069)/1728)*r^5 - ...
     ((388*gm^2+1161*gm+1881)/576)*r^3 + ...
     ((304*gm^2+831*gm+1242)/864)*r)*z + ...
     (((52*gm^2+51*gm+327)/192)*r^3 - ...
     ((52*gm^2+75*gm+279)/192)*r)*z^2 - ...
     ((7*gm-3)/12)*z^3;
    
u = 1 + u1/(rcsub+1) + (u1+u2)*(1/(rcsub+1))^2 + (u1+2*u2+u3)*(1/(rcsub+1))^3;
v = sqrt((gm+1)/(2*(rcsub+1)))*(v1*(1/(rcsub+1)) + (1.5*v1+v2)*(1/(rcsub+1))^2 + ...
    (1.875*v1+2.5*v2+v3)*(1/(rcsub+1))^3);

M = (u^2 + v^2)^0.5;
